@model FirstWebApplication.Models.ObstacleData
@{
    ViewData["Title"] = "Overview";
}
<main class="min-h-screen bg-gray-50">
  <div class="mx-auto max-w-xl px-4 py-10 sm:py-16">
    <h1 class="text-2xl sm:text-3xl font-semibold text-gray-900 mb-6">Obstacle Overview</h1>

    <div class="grid gap-4 bg-white p-6 rounded-xl shadow">
      <p><span class="font-semibold">Name:</span> @Model.ObstacleName</p>
      <p><span class="font-semibold">Height:</span> @Model.ObstacleHeight</p>
      <p><span class="font-semibold">Description:</span> @Model.ObstacleDescription</p>
    </div>

    <!-- Kartet for Ã¥ vise GeoJSON -->
    <div class="mt-6">
      <label class="block text-sm font-medium text-gray-700 mb-2">Obstacle location</label>
      <div id="map-overview" class="rounded-xl border border-gray-200" style="height:420px;"></div>
    </div>

    <div class="mt-6">
      <a asp-controller="Obstacle" asp-action="DataForm" class="text-blue-600 underline">Register another</a>
    </div>
  </div>
</main>

@section Scripts {
  <script>
    const map = L.map('map-overview').setView([58.1467, 7.9956], 12);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 20,
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    // Les GeoJSON fra modellen
    const geoJsonStr = '@(Model.GeometryGeoJson ?? "")'.replace(/&quot;/g, '"');

    if (geoJsonStr) {
      try {
        const gj = JSON.parse(geoJsonStr);
        const layer = L.geoJSON(gj).addTo(map);
        if (layer.getLayers().length > 0) {
          map.fitBounds(layer.getBounds(), { padding: [20,20] });
        }
      } catch (err) {
        console.warn("Kunne ikke lese GeoJSON:", err);
      }
    }
  </script>
}
